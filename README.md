# FINAL BACKEND-2024
## Файл содержит в себе инструкцию по развёртыванию проекта и документацию к API методам

# Развёртывание
### 1. Клонируйте репозиторий:
    git clone <url>

   Например: git clone https://github.com/name/repo.git

### 2. Перейдите в директорию проекта:
    cd <repository name>

    Например: cd backend

### 3. Запустите контейнеры:
    docker compose up -d --build

### 4. Зайдите в контейнер php:
    docker compose exec php sh

### 5. Установите скелет Symfony:
    composer install

### 6. Выйдите из текущего контейнера:
    exit

### 7. Откройте ваш браузер и зайдите на localhost:8080. Убедитесь, что открылась последняя версия Symfony.

### 8. Остановите работу контейнеров:
    docker compose stop

## Объяснение используемых команд:
    1. git clone <> - создание копии определённого проекта

    2. cd <> - переход в определённую директорию (папку)

    3. docker compose up -d --build - запуск контейнера

        Для проекта с множественными контейнерами используется docker-compose.yml, в котором описаны определения сервисов (контейнеров) и их взаимодействия. Например, образы, сети, порты и т.д.

        Образ - архив, в котором есть всё необходимое для создания контейнера.

        Dockerfile - инструкция по созданию образа.

    4. docker compose exec php sh - вход в контейнер.

        Используется, к примеру, чтобы посмотреть логи или установить зависимости.

    5. composer install - установка зависимостей (список пакетов, необходимые для работы приложения)

        В нашем случае composer должен установить скелет фреймворка Symfony. Чтобы это сделать, требуется файл composer.json. Его можно найти на официальном репозитории Symfony.

    6. exit - выход из контейнера

    7. docker compose stop - остановка работы всех контейнеров


# Документация к API методам
## 1. Получение всех пользователей (GET)

### Endpoint:
`GET /users/all`

### Описание:
Возвращает список всех зарегистрированных пользователей. Доступно только для пользователей с правами администратора.

### Запрос:
- **Заголовки:**
    - `token` : `string` — токен доступа администратора.

### Ответ:
- **200 OK**
    - Возвращает массив данных пользователей.
- **403 Forbidden**
    - Если пользователь не обладает правами администратора.

---

## 2. Регистрация пользователя (POST)

### Endpoint:
`POST /users/register`

### Описание:
Отправляет магическую ссылку для верификации email.

### Запрос:
- **Тело запроса (JSON):**
  ```json
  {
    "email": "string"
  }
  ```

### Ответ:
- **200 OK**
    - Возвращает сообщение об успешной отправке ссылки на почту
---

## 3. Верификация email (POST)

### Endpoint:
`POST /users/verify`

### Описание:
Верифицирует email пользователя с помощью магической ссылки (токена).

### Запрос:
- **Параметры запроса:**
    - `token`: `string` — Токен магической ссылки, отправленный по электронной почте.
- **Тело запроса (JSON):**
  ```json
  {
    "name": "string",
    "surname": "string"
  }
  ```

### Ответ:
- **201 Created**
    - Возвращает токены для дальнейшей работы.

---

## 4. Просмотр профиля пользователя (GET)

### Endpoint:
`GET /users/stats/{id}`

### Описание:
Возвращает информацию профиля пользователя по его идентификатору. Доступно только для администратора или самого пользователя.

### Запрос:
- **Параметры пути:**
    - `id`: `int` — ID пользователя.
- **Заголовки:**
    - `token` : `string` — Токен доступа пользователя.

### Ответ:
- **200 OK**
    - Возвращает данные профиля пользователя.
- **403 Forbidden**
    - Если у пользователя нет прав на просмотр профиля.

---

## 5. Редактирование профиля пользователя (PUT)

### Endpoint:
`PUT /users/edit/{id}`

### Описание:
Позволяет пользователю или администратору редактировать профиль пользователя по его идентификатору.

### Запрос:
- **Параметры пути:**
    - `id`: `int` — ID пользователя.
- **Заголовки:**
    - `token` : `string` — Токен доступа пользователя.
- **Тело запроса (JSON):**
  ```json
  {
    "name": "string",
    "surname": "string"
  }
  ```

### Ответ:
- **200 OK**
    - Возвращает обновленные данные пользователя.
- **403 Forbidden**
    - Если у пользователя нет прав на редактирование профиля.

---

## 6. Удаление пользователя (DELETE)

### Endpoint:
`DELETE /users/delete/{id}`

### Описание:
Удаляет пользователя по его идентификатору

### Запрос:
- **Параметры пути:**
    - `id`: `int` — ID пользователя.
- **Заголовки:**
    - `token` : `string` — Токен доступа.

### Ответ:
- **200 OK**
    - Возвращает сообщение об успешном удалении.
- **403 Forbidden**
    - Если у пользователя нет прав на удаление.

---

## 7. Блокировка пользователя (PUT)

### Endpoint:
`PUT /users/block/{id}`

### Описание:
Блокирует пользователя по его идентификатору. Доступно только для администратора.

### Запрос:
- **Параметры пути:**
    - `id`: `int` — ID пользователя.
- **Заголовки:**
    - `token` : `string` — Токен доступа администратора.

### Ответ:
- **200 OK**
    - Возвращает сообщение об успешной блокировке пользователя.
- **403 Forbidden**
    - Если у пользователя нет прав на блокировку.

---